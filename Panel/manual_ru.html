<!DOCTYPE html>
<html>
 <head>
   <title>Godzilla Loader - MANUAL</title>
   <meta charset="utf-8">
 </head>
 <body>
<p>

<center> <b>Системные требования:</b></center>
<ul>
  <li>PHP версии 5 и выше</li>
  <li>MySQL версии 5 и выше</li>
  <li>Доступ на чтение/запись к /tmp/* , /core/* и /files/*</li>
  <li>Расширение php openssl</li>
  <li>Планировщик задач(для автоматического обновления задач)</li>
 </ul>
Для установки ПУ необходимо запустить install.php в браузере, заполнить информацию о подключении к базе данных и авторизации.</br> 
После установки удалить install.php 
  
 </br> </br> <center><b>Настройка автообновления задач в панеле управления:</b></center> </br> </br>   
 Автообновление полезной нагрузки в списке задач задается в панеле управления, в разделе задач, пункт "Обновление". </br>
 Поддерживается загрузка файлов по протоколам HTTP, HTTPS, FTP, FTP/SSL. Подробнее см. <a href="http://php.net/manual/ru/stream.examples.php">php.net/manual/ru/stream.examples.php</a> 
 
</br>  Примеры и инструкции для настройки скрипта автоматического обновления можно найти по следующим ссылкам.</br>  
 <a href="https://masterhost.ru/support/doc/cron/">masterhost.ru/support/doc/cron</a> </br> 
 <a href="https://habrahabr.ru/post/255245/">habrahabr.ru/post/255245</a> </br> 
 <a href="http://www.php.su/articles/?cat=others&page=009">www.php.su/articles/?cat=others&page=009</a> </br> 
 А так же, скрипт можно вызывать удаленно, используя прямой запрос к <a href="http://example.com/pathtoloader/autoupdate.php">example.com/pathtoloader/autoupdate.php</a> </br> 
 Для совсем ленивых -  <a href="http://cronjob.ru/">cronjob.ru</a> </br> 
 <b style="color:red;">Важно!</b> Обновление может не произойти, если время заданного интервала еще не прошло с момента последнего обновления(в тч если обновление производится удаленно). 
 
 
   </br> </br><center> <b>Рекомендации по безопасности:</b></center></br> 
 <ol>
 <li>Переименовать файлы index.php, gate.php, guest.php и autoupdate.php</li>
 <li>По возможности ограничить доступ к ПУ(включая гейт) по IP-диапазону стран Китая (CN, TW) и Канады (CA).</br>
 Основной сегмент антивирусных аналитиков проживают именно в этих странах.</li>
 <li>Включить поддержку .htaccess(если вебсервер apache) или вручную настройть правила блокировки прямого доступа к файлам из директории:</br>
 /core/*</br>
 /files/*</br>
 /tmp/*</br>
 /templates/*</br></li>
 <li>Крипт. Детектируемость лоадера антивирусами напрямую зависит от качества крипта. Основных критериев здесь два: </br> 
   - 1. Уникальность стаба. Как правило, лоадер (<span style="color:green;">loader.exe</span>), помещается внутрь стаба криптора(<span style="color:red;">crypt.exe</span>). Чем больше людей будут использовать 
    стаб криптора(<span style="color:red;">crypt.exe</span>), тем быстрее и чаще будет палится лоадер (<span style="color:green;">loader.exe</span>).  </br> 
	Проверить легко - закриптуйте любой исполняемый файл и дайте ему отлежаться неделю, если через неделю закриптованный файл останется чистый - крипт хороший. </br>
   - 2. Полиморфизм. Некоторые недобрасовестные крипторы(читай - кидалы) используют схему "матрешки".</br> 
   Лоадер (<span style="color:green;">loader.exe</span>), помещается внутрь стаба криптора(<span style="color:red;">crypt.exe</span>), точно так же как и при нормальном крипте, но никаких операции по предотвращению детекта </br> 
	самого лоадера, не предпринимается. В момент запуска, <span style="color:red;">crypt.exe</span> расшифровывает в памяти процесса <span style="color:green;">loader.exe</span> и запускает его. </br> 
	Получается, что в НЕ запущенном состоянии, палево ехе на выходе(<span style="color:red;">crypt.exe</span>) остается чистым, в то время как после запуска детектируется сам <span style="color:green;">loader.exe</span> </br> 
	в памяти процесса.</br> 
	Чтобы убедится в добросовестности криптора, достаточно проверить закриптованный файл (<span style="color:red;">crypt.exe</span>) совместно с чистым файлом лоадера (<span style="color:green;">loader.exe</span>),
	предварительно отключив(только для <span style="color:green;">loader.exe</span>) сигнатурный детект в настройках антивируса. </br> 
    <i>Пример</i>: Антивирус NOD32, включена функция "Мониторинг памяти"(включена по умолчанию), на ПК два файла в архиве - <span style="color:red;">crypt.exe</span> и <span style="color:green;">loader.exe</span>.</br> 
	После распаковки архива - детектируется <span style="color:green;">loader.exe</span>(найдена сигнатура), <span style="color:red;">crypt.exe</span> остается чистым.</br> 
	Запуск <span style="color:red;">crypt.exe</span> - детект.</br>
	Чтобы убедится в том, что детект идет именно из за палевности самого лоадера, нужно на время отключить функцию "сигнатурного детекта" </br> 
	и запустить чистый(без крипта) <span style="color:green;">loader.exe</span>. </br> Если запуск пройдет успешно - крипт сделан в виде матрешки.</li>
 <li>Вынести все файлы панели управления на сторонний хост\виртуалхост\порт.
	Детект ПУ может произойти даже без участия ехе. </br> 
	Структура панели управления уникальна, кол-во файлов, имена директории, файлов, их размер и хешсумма каждого файла.</br>
	Это дает возможность не имея доступа к панеле управления, с точностью определить, название, тип и версию малвари.</br> 
	Если панель управлния будет обнаружена, методом подбора(разная ОСЬ, разные IP) будут скачены все файлы находящиеся в задачах.</br>
	Для работы гейта в изолированном состоянии достаточно подправить инклуиды и путь до файла геоип базы.</li>
	
	<li>Не держите задачи активными, если они уже выполнены. Эти файлы могут скачать не только боты, но и антивирусные аналитики.</li>
	
	<li> Завалялись шелы, ftp/sftp доступы? Используйте их в качестве прокладок, при заказе ребилда - количество доменов не ограниченно.</br>
	А проверка RSA подписи ответа сервера, гарантирует защиту ботнета от угона.</br>
	</li>
	<li>Даже несмотря на все вышесказанные рекомендации, ботнет может палится очень быстро. Причиной тому - рекция пользователей.</br>
	  После начала распространения, бдительные пользователи загружают лоадер на <a href="https://virustotal.com/">virustotal.com</a></br>
	  Вопреки всеобщему заблуждению, virustotal проверяет файлы не только по сигнатурам, но и запускает их.</br>
	  Используются виртуальные машины на базе QEMU, с установленными патчами на детект виртуализации. </br>
	  Никакие из паблик способов определение виртуализации на этих машинах <span style="color:red;">НЕ РАБОТАЮТ</span>.</br>
	  Это приводит не только к детекту самого лоадера, но и всех файлов, которые он загружает.</br>
	  Человек в этом процессе не учавствует, все делается автоматически, в том числе и наложение сигнатур на полученные файлы.</br>
	  Автоматизация процесса(загрузка ехе на вирт. машину, запуск, мониторинг) выполняется, как правило, на скритповых языках  cmd/bat, perl, реже AutoIt и PHP.</br>
	</li>
</ol>


<center><b> F.A.Q. </b></center></br>
<ul>
<li>
<span style="color:red;"> При прогрузе с связки Х, отстучало в админку лоадера всего 10-20% ботов. Почему?</br></span>
<span style="color:green;"> Варианта два:</br>
1. Стата в админке связки нарисована. Чтобы проверить сравните результат с любым другим файлом.</br>
2. Запуск лоадера обламывается из за некоретного запуска под Low IL. Для выхода из под Low IL используется запуск окна UAC в цикле до победного. </br>
Если криптор поломал ехе, или же, некоректно передает путь до закриптованного файла - с запуском могут быть проблемы.</br>
Чтобы проверить, заразите себя через связку, после того, как появится окно UAC, нажмите Подробно и посмотрите, по указанному пути действительно ли находится закриптованный лоадер?</br>
</span>
</li>
<li><span style="color:red;"> Хочу заказать сразу несколько ребилдов, можно?</br></span>
<span style="color:green;"> При наличии хорошей репутации и/или совместной работы от 1 месяца - да.</br>
Так же хочу заметить, если будет обнаружен факт ресселинга - будете лишены лицензии, без возможности возврата денежных средств</br></span>
</li>
<li><span style="color:red;"> В чем отличие не резидентной версии от резидентной?</br></span>
<span style="color:green;"> Отличие только одно, резидентная версия добавляет себя в автозагрузку системы, тем самым позволяя подгружать</br>
при необходимости новые задачи. Различий в способах обходов AV-защиты, выхода из Low IL, загрузке и запуске файлов - нет.</br></span>
</li>
<li><span style="color:red;"> Как проверить, корректно настроена панель управления, или нет?</span></br>
<span style="color:green;"> Достаточно добавить задачу и открыть в браузере просмотр исходного кода путя http://host/loader/gate.php</span></br>
</li>
</ul>

 </p>
</br> При возникновении ошибок, жалоб и предложений, </br> 

alfamale@exploit.im </br> 
alfamale@dlab.im </br> 
 </body> 
</html>